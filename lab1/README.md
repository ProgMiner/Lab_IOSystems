# Лабораторная работа 1
## Вариант 1

**Название:** "Разработка драйверов символьных устройств"

**Цель работы:** получение знаний и навыков разработки драйверов символьных устройств
для ОС GNU/Linux.

## Описание функциональности драйвера

При записи текста в файл символьного устройства должен осуществляться подсчет введенных символов.
Последовательность полученных результатов (количество символов) с момента загрузки модуля ядра
должна выводиться при чтении созданного файла `/proc/var1` в консоль пользователя.

При чтении из файла символьного устройства в кольцевой буфер ядра должен осуществляться
вывод тех же данных, которые выводятся при чтении файла `/proc/var1`.

## Инструкция по сборке

**Используется ядро Linux версии 5.4.97-gentoo**

Сборка драйвера:
```bash
make
```

Собирается и создаётся файл `lab1.ko`

Загрузка драйвера в систему:
```bash
make load
```

Выгрузка драйвера из системы:
```bash
make unload
```

Очистка директории от создаваемых файлов:
```bash
make clean
```

## Инструкция пользователя

Чтобы записать данные в `/dev/lab1` нужно воспользоваться командой `echo` или `dd`
```bash
echo 1234 | sudo tee /dev/lab1
sudo dd if=/dev/zero of=/dev/lab1 bs=512 count=1 # запись 512 NUL-байтов
```

Чтобы прочитать данные из `/dev/lab1` нужно воспользоваться командой `cat`
```bash
sudo cat /dev/lab1
```

Для просмотра кольцевого буфера нужно воспользоваться командой `dmesg`
``` bash
sudo dmesg
```

Чтобы прочитать данные из `/proc/var1` нужно воспользоваться командой `cat`
```bash
cat /proc/var1
```

## Примеры использования

![test](https://github.com/ProgMiner/io-systems/blob/master/lab1/img/test.jpg?raw=true)

## Заключение

В результате проделанной работы Эридан написал большую часть драйвера,
я прочитал все статьи по этой теме, которые нашёл на русском языке,
и некоторое количество импортных, но так до конца и не разобрался в теме (ИМХО). 

А если серьёзно, то интересно работать на уровне ядра, особенно когда все ломается.
Не уследил за утечкой памяти, БАБАХ, ОЗУ 100%, дискорд вылетел, сидишь бухтишь.
